# Это скрипт для GNU Octave. Операции "./", ".*", ".^" - это обычные операции умножения, только применяемые на массивы (i-ый элемент результата получается применением операции к i-ым элементам исходных массивов)
format long eng
format compact

# Диаметр ракеты "Метеор" составляет 0,178 метра
d=0.178
# Масса ракеты, кг
mass=185
# Аэродинамическое качество ракеты: взято как будто нет крыльев вообще
Qair=1
# Сила, которая затрачивается на поддержание ракеты навесу
massF=mass*9.81/Qair


# Дополнительная площадь воздухозаборников, которая, как считаем, тоже создаёт сопротивление, как и головной обтекатель
SairR=0.0064*2

# 0,5 - константа лобового сопротивления от какой-то ракеты, работающей на сверхзвуке; для дозвука она же даёт 0,2; взято отсюда https://habr.com/ru/articles/652407/
C=0.5

# Плотность воздуха на заданной высоте, кг/м^3
# Высоты:
altitudes=[2 7 12 20 24 36 40]
ro=[1.0 0.59 0.3119 0.0889 0.0469 7.26e-3 4e-3]

# Скорость звука на данной высоте, м/с
M=[332.5 312.3 295.1 295.1 297.7 310.1 317.2]

# Скорость в махах нашей ракеты
VM=[1.1 2 4 4 4 4 4]

# Масса керосина
Vkerosene=50
# Минимальное давление для горения керосина в двигателе
roInDriveMin=1

# На это делится идеальный КПД нашего двигателя
etaQuotitent=2


# Рассчитываем КПД двигателя в зависимости от скорости
# Показатель адиабаты сухого воздуха
kair=1.4;
# Идеальное КПД двигателя
etai=1 - 1 ./ ( 1 + (kair-1)/2*VM.^2 )
# Считаем, что реальное КПД двигателя в два раза меньше
eta=etai/etaQuotitent


# Рассчитываем уплотнение воздуха
betaA=(kair-1)/2*VM.^2;
beta=(1+betaA).^(kair/(kair-1));
# Плотность внутри двигателя, считая, что чем больше давление, тем пропорционально больше и плотность (хотя это не так, т.к. воздух ещё и нагревается)
roInDrive=beta.*ro



# Воздушная скорость
v=VM.*M

# Площадь. SairR - это площадь воздухозаборников
S=pi*d^2/4+SairR
# Скоростной напор
P=C*ro.*v.^2/2;
F=S*P
F+=massF

# Мощность потерь
W=F.*v

# Мощность сгорания топлива должна составить
Wf=W./eta

# Теплота сгорания керосина 43 МДж/кг. Следовательно, за одну секунду должно сгореть порядка M1 килограммов керосина.
Q=43e6;M1=Wf/Q

# Судя по поисковой выдаче, на 1 кг керосина приходится 3,4 кг чистого кислорода. 3.4/0.231=14.719 водуха (по некоторым источникам: 14.8, так что возьмём большую цифру). km0=14.8. Учтём коэффициент разбавления (пусть горит обеднённая смесь), допустим, 1,25. Плюс, допустим (от балды), что 25% воздуха не попадает в воздухозаборник, так что нужно чуть больше воздуха.
km0=14.8;
km=km0*1.25*1.25;
M1air=M1*km


# Рассчитаем приблизительную площадь воздухозаборников, потребную для получения такого количества воздуха (тут, возможно, лучше было бы найти учебник с таким расчётом: там точно будет сложнее).
# M1air=ro*Sair*v;
Sair=M1air./ro./v

# Коэффициент. Если Ksair больше 1, то воздухозаборника не хватает.
Ksair=Sair/SairR

# Время работы двигателя
t=Vkerosene./M1

# Дальность полёта без учёта формулы Циолковского (без учёта выгорания топлива)
Distance=t.*v;

for i = 1:length(roInDrive)
  if (roInDrive(i) < roInDriveMin)
    Distance(i) = 0;
  endif
  if (Sair(i) == Inf)
    Distance(i) = 0;
  endif
end

format short g
fixed_point_format(true)
output_precision(3)

Lrow=min(12, length(altitudes));

disp("Высота, км")
disp(altitudes(1:Lrow))
disp("Дистанция применения, км")
disp(Distance(1:Lrow)/1e3)
disp("Нехватка воздухозаборников, разы")
disp(Ksair(1:Lrow))

if (Lrow < length(altitudes))
disp("Высота, км")
disp(altitudes(Lrow+1:length(altitudes)))
disp("Дистанция применения, км")
disp(Distance(Lrow+1:length(Distance))/1e3)
disp("Нехватка воздухозаборников, разы")
disp(Ksair(1:Lrow))
endif

format long eng
fixed_point_format(false)
