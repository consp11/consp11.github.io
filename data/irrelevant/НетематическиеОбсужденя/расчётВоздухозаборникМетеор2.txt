# Это скрипт для GNU Octave. Операции "./", ".*", ".^" - это обычные операции умножения, только применяемые на массивы (умножение i-ый элемента на другой i-ый элемент)
format long eng

# Диаметр ракеты "Метеор" составляет 0,178 метра
d=0.178
# Дополнительная площадь воздухозаборников, которая, как считаем, тоже создаёт сопротивление, как и головной обтекатель
SairR=0.0064*2

# 0,5 - константа лобового сопротивления от какой-то ракеты, работающей на сверхзвуке; для дозвука она же даёт 0,2; взято отсюда https://habr.com/ru/articles/652407/
C=0.5

# Плотность воздуха на заданной высоте, кг/м^3
# Высоты: [2 12 24]
ro=[1.0 0.3119 0.0469]

# Скорость звука на данной высоте, м/с
M=[332.5 295.1 297.7]

# Скорость в махах нашей ракеты
VM=[1.1 4 4]

# Масса керосина
Vkerosene=50


# Рассчитываем КПД двигателя в зависимости от скорости
# Показатель адиабаты сухого воздуха
kair=1.4;
# Идеальное КПД двигателя
etai=1 - 1 ./ ( 1 + (kair-1)/2*VM.^2 )
# Считаем, что реальное КПД двигателя в два раза меньше
eta=etai/2


# Рассчитываем уплотнение воздуха
betaA=(kair-1)/2*VM.^2;
beta=(1+betaA).^(kair/(kair-1));
# Плотность внутри двигателя, считая, что чем больше давление, тем пропорционально больше и плотность (хотя это не так, т.к. воздух ещё и нагревается)
roInDrive=beta.*ro



# Воздушная скорость
v=VM.*M

# Площадь. SairR - это площадь воздухозаборников
S=pi*d^2/4+SairR
# Скоростной напор
P=C*ro.*v.^2/2;
F=S*P

# Мощность потерь
W=F.*v

# Мощность сгорания топлива должна составить
Wf=W./eta

# Теплота сгорания керосина 43 МДж/кг. Следовательно, за одну секунду должно сгореть порядка M1 килограммов керосина.
Q=43e6;M1=Wf/Q

# Судя по поисковой выдаче, на 1 кг керосина приходится 3,4 кг чистого кислорода. 3.4/0.231=14.719 водуха (по некоторым источникам: 14.8, так что возьмём большую цифру). km0=14.8. Учтём коэффициент разбавления (пусть горит обеднённая смесь), допустим, 1,25. Плюс, допустим (от балды), что 25% воздуха не попадает в воздухозаборник, так что нужно чуть больше воздуха.
km0=14.8;
km=km0*1.25*1.25;
M1air=M1*km


# Рассчитаем приблизительную площадь воздухозаборников, потребную для получения такого количества воздуха (тут, возможно, лучше было бы найти учебник с таким расчётом: там точно будет сложнее).
# M1air=ro*Sair*v;
Sair=M1air./ro./v

# Коэффициент. Если Ksair больше 1, то воздухозаборника не хватает.
Ksair=Sair/SairR

# Время работы двигателя
t=Vkerosene./M1

# Дальность полёта без учёта формулы Циолковского (без учёта выгорания топлива)
Distance=t.*v

