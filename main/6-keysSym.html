<!DOCTYPE html>
<!-- consp.8vs.ru fdsc -->

<html>
<head>
<title>Обмен симметричными ключами</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
</head>
<body style="white-space: pre-wrap; font-size: 26px">

<a href="../index.html">На главную</a>

<h1>Обмен симметричными ключами</h1>

Обмен симметричными ключами проводится только лично с помощью носителя информации.
В целом, обмен похож на удалённый обмен ключами, но осуществляется только лично (через посредника или напрямую). Отличие состоит в том, что симметричные ключи не посылаются посредством каналов связи. То есть файлы sym.key, после зашифрования, обмениваются посредством обмена флешек.

<a href=./6-flashreq.html>Требования к флешкам, участвующим в обмене</a>


Рома и Коля хотят обменяться симметричными ключами.

1. Генерируются и согласовываются новые асимметричные ключи шифрования. Например, Рома генерирует RSA-ключи и посылает их Коле. Однако, симметричный ключ sym.key не посылается, хотя и генерируются.

Как вариант, и Коля и Рома генерируют RSA-ключи и посылают их друг другу. Но sym.key остаются у каждого свои, они не передаются по сети.


2. sym.key шифруются абсолютно также, как и до этого. Но записываются на флеш-память в зашифрованном виде, следуя инструкциям по <a href=./6-flashreq.html>ссылке выше</a>.

Флеш-память передаётся далее при личной встрече. Если генерация RSA-ключей шла со стороны Ромы, то флеш передаётся со стороны Коли.
Если генерация шла с обоих сторон, то и Рома, и Коля передают друг другу флешки с шифрованными sym.key .
Допускается дополнительно передавать на листах бумаги пароли (или части паролей) от шифрованных файлов. Пароли после расшифровки <a href=./5-paper.html>уничтожаются</a>.
Помните, что на бумаге могут остаться невидимые глазу отпечатки пальцев, которые докажут, что бумага была получена от другого лица (это важно, если это может быть компрометирующим обстоятельством для кого-то из этих лиц).


3. Данные с флеш копируются.
Ключи шифруются и хранятся надёжным способом.
Флеш обязательно <a href=./6-flash.html>перезатирается</a>, несмотря на то, что она была шифрованная.


4. Далее, происходит обмен фразами, которые означают, что ключи успешно расшифрованы. Либо сразу идёт переход к пункту 5.


5. Проверка работоспособности ключей.

1) Рома шлёт Коле некоторое случайное послание, например "0Hz68JjU80QmxDITISjvQZmZ". Оно зашифровано согласованным симметричным ключом (или обоими в согласованном порядке).

2) Коля делает аналогично, например, шлёт "6laqIONfQoM4ToHScjQPlABQe6629Y5V". Это иммитация реального обмена сообщениями.
Оба запоминают то, что послали.

3) Рома расшифровывает послание от Коли. Получает "6laqIONfQoM4ToHScjQPlABQe6629Y5V".

4) Коля получает от Ромы "0Hz68JjU80QmxDITISjvQZmZ".

5) Коля вычисляет хеш от расшифрованного послания и шлёт Роме. Рома шлёт хеш - Коле.

6) Оба проверяют, что хеши верные и сообщают в шифрованном виде об этом друг другу.
Канал связи установлен.


6. Только после этого Рома и Коля могут воспользоваться ключами шифрования для шифрования информации.

7. Сделать иные специальные действия: возможно, уничтожить флешку физически.

Обращу внимание на следующие моменты. 

Пока обе стороны не подтвердили получение ключа шифрования, шифровать что-либо таким ключом нельзя. Потому что ключ, теоретически, может быть похищен или потерян. И тогда уже ключ может попасть не к тем людям, которые смогут расшифровать уже зашифрованное сообщение.

Описанный выше процесс полностью повторяет процесс удалённого согласования ключей. Только вместо защищённого канала связи используется личная передача носителя информации (флешки).

Шифрование необходимо для того, чтобы в случае, если с флешки каким-то способом всё-таки смогли восстановить информацию, она была бы зашифрована. Если вы передаёте флешку лично, это ещё не так важно. Но когда вы передаёте флешку через посредника, то это позволяет доверять посреднику в меньшей степени, так как информация дополнительно защищена шифрованием.


Зачем уничтожать флешку физически?
Это не всегда нужно.
Если есть возможность, вы можете вернуть флешку тому человеку, от которого её получили. Но если встреча сопряжена с риском, то ради одной флешки смысла рисковать нет. Смысл как раз в том, что вы уже обменялись ключами шифрования и больше личных встреч вы производить вам нет необходимости.
После возврата флешки человек, которому вы её вернули, должен задуматься над стиранием отпечатков ваших пальцев с флешки, если эти отпечатки могут его скомпрометировать (например, вы журналист).


Если же флешку вернуть возможности нет, то:
1. Безопаснее всего флешку уничтожить физически либо выбросить после безопасного перезатирания
2. 


<a href=./6-flash.html>Перезатирание флеш-памяти</a>

<a href=./6-flashreq.html>Флешки для обмена</a>

</body>
</html>
